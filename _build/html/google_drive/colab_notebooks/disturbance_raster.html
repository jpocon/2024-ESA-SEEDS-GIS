

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mapping Fire Impacts - Raster-based &#8212; 2024 ESA SEEDS GIS Workshop</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'google_drive/colab_notebooks/disturbance_raster';</script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Mapping Fire Impacts - LiDAR-based" href="disturbance_lidar.html" />
    <link rel="prev" title="Principal Component Analysis &amp; Kmeans Clustering" href="pca_kmeans.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../about.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/update_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/update_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../about.html">
                    Welcome to the 2024 ESA SEEDS GIS Workshop!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Set Up</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="google_tools.html">Getting Started with Google Tools for GIS and Ecological Applications</a></li>



<li class="toctree-l1"><a class="reference internal" href="mount_drive.html"><strong>Mounting Google Drive</strong></a></li>



<li class="toctree-l1"><a class="reference internal" href="update_url_download.html">Download data directly from URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="geemap_python_api.html"><strong><code class="docutils literal notranslate"><span class="pre">geemap</span></code> Setup in Colab</strong></a></li>



</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">GIS &amp; Remote Sensing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="update_background.html">Getting Started with GIS &amp; Remote Sensing</a></li>


<li class="toctree-l1"><a class="reference internal" href="update_neon_aop.html"><strong>Introduction to NEON AOP</strong></a></li>





</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Group Exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pca_kmeans.html"><strong>Principal Component Analysis &amp; Kmeans Clustering</strong></a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Mapping Fire Impacts - Raster-based</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="disturbance_lidar.html"><strong>Mapping Fire Impacts - LiDAR-based</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="landcover_zonalstats.html"><strong>Zonal Stats: Exploring spectra by land cover</strong></a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/jpocon/2024-ESA-SEEDS-GIS/blob/master/google_drive/colab_notebooks/disturbance_raster.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/jpocon/2024-ESA-SEEDS-GIS" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/google_drive/colab_notebooks/disturbance_raster.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mapping Fire Impacts - Raster-based</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Mapping Fire Impacts - Raster-based</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflection-exercises-for-each-group">Reflection exercises for each group:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgement">Acknowledgement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bringing-in-vector-data-fire-exploration">Bringing in vector data (fire exploration)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="section" id="mapping-fire-impacts-raster-based">
<h1><strong>Mapping Fire Impacts - Raster-based</strong><a class="headerlink" href="#mapping-fire-impacts-raster-based" title="Permalink to this heading">#</a></h1>
<div class="section" id="reflection-exercises-for-each-group">
<h2>Reflection exercises for each group:<a class="headerlink" href="#reflection-exercises-for-each-group" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>At the top of the Colab notebook that you share with everyone, please include your responses to the following questions:</p></li>
</ol>
<ul class="simple">
<li><p>Choose at least 1 dataset to explore in more detail.</p></li>
<li><p>What is the projection for this dataset?</p></li>
<li><p>Where can you find more information on how the data were collected and how to interpret the metadata?</p></li>
<li><p>Think about what data type each variable is.</p></li>
<li><p>Is it vector or raster data? What properties exist for each dataset?</p></li>
<li><p>What resolution are your data?</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>At the top of the Colab notebook, write a short summary detailing the processing steps in the notebook and your results.</p></li>
</ol>
<ul class="simple">
<li><p>Although these topics may be far removed from your own interests, how could these steps and analyses help in your own work?</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>OPTIONAL - Expand your script by adding additional processing, analysis, or other data.</p></li>
</ol>
<p>As you’re working through your exercise, <strong>add code chunks to further document your scripts. Add additional comments to the code itself to clarify complicated processes.</strong></p>
<hr class="docutils" />
</div>
<div class="section" id="acknowledgement">
<h2>Acknowledgement<a class="headerlink" href="#acknowledgement" title="Permalink to this heading">#</a></h2>
<p>The code and comments for this project were adpated from NEON in <a class="reference external" href="https://www.neonscience.org/resources/learning-hub/tutorials/intro-aop-data-google-earth-engine-tutorial-series#toggle-36">this tutorial</a>. Check it out (or any of their other awesome tutorials!) to learn more!</p>
</div>
<div class="section" id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this heading">#</a></h2>
<p>In this first section, we’ll explore the Soaproot Saddle NEON site in California before and after a 2020 burn. We’ll map the reflectance data, RGB data, and difference in normalized burn ratio (dNBR).</p>
<div id="ds-objectives" markdown="1">
</div>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this heading">#</a></h2>
<p>The <strong>Creek Fire</strong> was a large wildfire that started in September 2020 in the Sierra National Forest, California and became one of the largest fires of the <a class="reference external" href="https://en.wikipedia.org/wiki/2020_California_wildfires">2020 California wildfire season</a>. This fire had burned into NEON’s <a class="reference external" href="https://www.neonscience.org/field-sites/soap">Soaproot Saddle (SOAP)</a> site by mid-September, causing a <a class="reference external" href="https://www.neonscience.org/impact/observatory-blog/domain-digest-no-4-fire-field-sites-and-recovery">high intensity burn over much of the site</a> - standing trees became charcoal spires, shrubs and their root systems burned completely, the thick litter layer was incinerated, and the soil severely burned.</p>
<p>The NEON Airborne Observation Platform (AOP) conducted aerial surveys over SOAP in 2019 and 2021, a year before and after the Creek Fire.</p>
<p>In our introduction to AOP data, we learned how to calculate NDVI. Another common vegetation index is NBR, the normalized burn ratio. NBR is commonly used to asses burn severity. NBR is calculated as: <br></p>
<blockquote>
<div><p>NBR = (NIR – SWIR) / (NIR + SWIR)</p>
</div></blockquote>
<p><img src='https://drive.google.com/uc?export=view&id=1zUP9oDdeQdiyQGL-2Vh1aqz8QCy03XPR' width=400> Image credit: <a class="reference external" href="https://appliedsciences.nasa.gov/sites/default/files/ChangeDetection_S1.pdf">NASA ARSET Training Materials</a></p>
<p>Then, dNBR is the difference in NBR, which is calcualted as <br></p>
<blockquote>
<div><p>dNBR = prefire NBR - postfire NBR</p>
</div></blockquote>
<p>The USGS proposes the following categories based on dNBR:<br>
<img src='https://drive.google.com/uc?export=view&id=1firJsT-ON56_LYII9MErCw1UC6V8Y3QD' width=600>Image credit: <a class="reference external" href="https://www.earthdatascience.org/courses/earth-analytics/multispectral-remote-sensing-modis/normalized-burn-index-dNBR/">Earth Lab</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ee</span>
<span class="kn">import</span> <span class="nn">geemap</span>
<span class="kn">import</span> <span class="nn">geemap.colormaps</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="n">ee</span><span class="o">.</span><span class="n">Authenticate</span><span class="p">()</span>
<span class="n">ee</span><span class="o">.</span><span class="n">Initialize</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">geemap</span><span class="o">.</span><span class="n">ee_initialize</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the AOP surface directional reflectance (SDR)</span>
<span class="n">aopSDR</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;projects/neon-prod-earthengine/assets/DP3-30006-001&#39;</span><span class="p">)</span>
<span class="c1"># Import the AOP red-green-blue imagery (RGB)</span>
<span class="n">aopRGB</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;projects/neon-prod-earthengine/assets/DP3-30010-001&#39;</span><span class="p">)</span>
<span class="c1"># Import the AOP canopy height model data (CHM)</span>
<span class="n">aopCHM</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;projects/neon-prod-earthengine/assets/DP3-30015-001&#39;</span><span class="p">)</span>
<span class="c1"># Import the AOP digital elevation model data (DEM)</span>
<span class="n">aopDEM</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">ImageCollection</span><span class="p">(</span><span class="s1">&#39;projects/neon-prod-earthengine/assets/DP3-30024-001&#39;</span><span class="p">)</span>

<span class="c1"># Set up visualization params</span>
<span class="n">RGB_bands</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B053&#39;</span><span class="p">,</span> <span class="s1">&#39;B035&#39;</span><span class="p">,</span> <span class="s1">&#39;B019&#39;</span><span class="p">]</span> <span class="c1"># These are the band names for the red, green, blue bands in the SDR data</span>
<span class="n">rgbVis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">}</span> <span class="c1"># This sets a nice range of values for mapping the RGB data</span>
<span class="n">sdrVis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">1260</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">}</span> <span class="c1"># This sets a nice range of values for mapping the RGB data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">### Code and comments adpated from NEON at https://www.neonscience.org/resources/learning-hub/tutorials/intro-aop-data-google-earth-engine-tutorial-series#toggle-36</span>
<span class="sd">&#39;&#39;&#39;------------------------- Normalized Difference Burn Ratio ----------------------------</span>
<span class="sd">The normalized burn ratio (NBR) is a normalized difference index using the shortwave-infrared (SWIR) and near-infrared (NIR) portions of the electromagnetic spectrum.</span>
<span class="sd">dNBR can be used as a metric to map fire extent and burn severity when calculating the difference between pre and post fire conditions.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Import the 2019 and 2021 SOAP data</span>
<span class="n">SOAP_2019_sdr</span> <span class="o">=</span> <span class="n">aopSDR</span> \
  <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2019-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-31&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;NEON_SITE&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;SOAP&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">first</span><span class="p">()</span>

<span class="n">SOAP_2021_sdr</span> <span class="o">=</span> <span class="n">aopSDR</span> \
  <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;NEON_SITE&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;SOAP&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">first</span><span class="p">()</span>

<span class="n">SOAP_2019_rgb</span> <span class="o">=</span> <span class="n">aopRGB</span> \
  <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2019-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-31&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;NEON_SITE&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;SOAP&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">first</span><span class="p">()</span>


<span class="n">SOAP_2021_rgb</span> <span class="o">=</span> <span class="n">aopRGB</span> \
  <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;NEON_SITE&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;SOAP&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">first</span><span class="p">()</span>


<span class="c1">## Create an ROI that talks only the pixels covered by both years + adds -30m buffer</span>
<span class="n">full_mask</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">SOAP_2019_sdr</span><span class="o">.</span><span class="n">geometry</span><span class="p">())</span> \
                <span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">SOAP_2019_sdr</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;B001&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mask</span><span class="p">())</span> \
                <span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">SOAP_2021_sdr</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s1">&#39;B001&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mask</span><span class="p">())</span> \
                <span class="o">.</span><span class="n">reduceToVectors</span><span class="p">(</span><span class="n">maxPixels</span><span class="o">=</span><span class="mf">1e13</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ROI</span> <span class="o">=</span> <span class="n">full_mask</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># calculate NBR</span>
<span class="c1"># B097: B365:</span>
<span class="n">pre_nbr</span> <span class="o">=</span> <span class="n">SOAP_2019_sdr</span><span class="o">.</span><span class="n">normalizedDifference</span><span class="p">([</span><span class="s1">&#39;B097&#39;</span><span class="p">,</span> <span class="s1">&#39;B365&#39;</span><span class="p">])</span>
<span class="n">post_nbr</span> <span class="o">=</span> <span class="n">SOAP_2021_sdr</span><span class="o">.</span><span class="n">normalizedDifference</span><span class="p">([</span><span class="s1">&#39;B097&#39;</span><span class="p">,</span> <span class="s1">&#39;B365&#39;</span><span class="p">])</span>

<span class="c1"># calculate dNBR</span>
<span class="n">dNBR</span> <span class="o">=</span> <span class="n">pre_nbr</span> \
        <span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">post_nbr</span><span class="p">)</span>

<span class="c1"># Mapping</span>
<span class="n">vis_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span><span class="n">cm</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;RdYlGn_r&#39;</span><span class="p">,</span> <span class="n">n_class</span><span class="o">=</span><span class="mi">20</span><span class="p">)}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>


<span class="c1"># # add RGB base</span>
<span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">SOAP_2019_rgb</span><span class="p">,</span> <span class="n">rgbVis</span><span class="p">,</span> <span class="s1">&#39;SOAP 2019 RGB&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">SOAP_2021_rgb</span><span class="p">,</span> <span class="n">rgbVis</span><span class="p">,</span> <span class="s1">&#39;SOAP 2021 RGB&#39;</span><span class="p">)</span>

<span class="c1"># # add NBR layers</span>
<span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">pre_nbr</span><span class="p">,</span> <span class="n">vis_params</span><span class="p">,</span> <span class="s1">&#39;2019 Normalized Burn Ratio&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">post_nbr</span><span class="p">,</span> <span class="n">vis_params</span><span class="p">,</span> <span class="s1">&#39;2021 Normalized Burn Ratio&#39;</span><span class="p">)</span>

<span class="c1"># add dNBR layer</span>
<span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">dNBR</span><span class="p">,</span> <span class="n">vis_params</span><span class="p">,</span> <span class="s1">&#39;dNBR&#39;</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">ROI</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="bringing-in-vector-data-fire-exploration">
<h1>Bringing in vector data (fire exploration)<a class="headerlink" href="#bringing-in-vector-data-fire-exploration" title="Permalink to this heading">#</a></h1>
<p>Now, let’s compare our map of dNBR with existing fire data. The MTBS (Monitoring Trends in Burn Severity) data product is already publicly available on GEE.</p>
<p>In the next code chunk, we’ll inspect 1 feature (representing a fire polygon) from MTBS. We extract the feature of interested by filtering the MTBS FeatureCollection to our area of interest and the year 2020.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MTBS</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s2">&quot;USFS/GTAC/MTBS/burned_area_boundaries/v1&quot;</span><span class="p">)</span> \
              <span class="o">.</span><span class="n">filterBounds</span><span class="p">(</span><span class="n">SOAP_2021_sdr</span><span class="o">.</span><span class="n">geometry</span><span class="p">())</span> \
              <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">feat</span><span class="p">:</span> <span class="n">feat</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;system:time_start&#39;</span><span class="p">,</span> <span class="n">feat</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ig_Date&#39;</span><span class="p">)))</span> \
              <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-01-01&#39;</span><span class="p">)</span>
<span class="n">MTBS</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let’s overlay the MTBS data product on our dNBR map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mapping</span>
<span class="n">vis_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span><span class="n">cm</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;RdYlGn_r&#39;</span><span class="p">,</span> <span class="n">n_class</span><span class="o">=</span><span class="mi">20</span><span class="p">)}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>


<span class="c1"># # add RGB base</span>
<span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">SOAP_2019_rgb</span><span class="p">,</span> <span class="n">rgbVis</span><span class="p">,</span> <span class="s1">&#39;SOAP 2019 RGB&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">SOAP_2021_rgb</span><span class="p">,</span> <span class="n">rgbVis</span><span class="p">,</span> <span class="s1">&#39;SOAP 2021 RGB&#39;</span><span class="p">)</span>

<span class="c1"># add dNBR layer</span>
<span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">dNBR</span><span class="p">,</span> <span class="n">vis_params</span><span class="p">,</span> <span class="s1">&#39;dNBR&#39;</span><span class="p">)</span>

<span class="c1"># add MTBS layer</span>
<span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">MTBS</span><span class="p">)</span>

<span class="n">m</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">ROI</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we’ve seen the boundary of the 2020 Creek Fire, let’s use the canopy 2019 and 2021 height model (CHM) and the Creek Fire Boundary to see the change in canopy height post-fire at the SOAP site.</p>
<p>First, we’ll show the distribution of changes in canopy height post-fire for the entire burn region.</p>
<p>Then, we’ll use dNBR thresholds to estimate “high severity” vs “low severity” burn regions within the burned area, and plot the distribution of changes in canopy height by estimated severity. <br>
<em>Note: If you’re interested in fire severity classifications, MTBS also has a burn severity raster product available on GEE!</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the CHM for 2019 and 2021</span>
<span class="n">SOAP_2019_chm</span> <span class="o">=</span> <span class="n">aopCHM</span> \
  <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2019-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2019-12-31&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;NEON_SITE&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;SOAP&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">first</span><span class="p">()</span>


<span class="n">SOAP_2021_chm</span> <span class="o">=</span> <span class="n">aopCHM</span> \
  <span class="o">.</span><span class="n">filterDate</span><span class="p">(</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-12-31&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;NEON_SITE&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;SOAP&#39;</span><span class="p">)</span> \
  <span class="o">.</span><span class="n">first</span><span class="p">()</span>

<span class="c1"># Convert rasterize the MTBS polygon</span>
<span class="n">creek_img</span> <span class="o">=</span> <span class="n">MTBS</span><span class="o">.</span><span class="n">reduceToImage</span><span class="p">(</span><span class="n">properties</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;BurnBndAc&#39;</span><span class="p">],</span> <span class="n">reducer</span><span class="o">=</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">anyNonZero</span><span class="p">())</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">ROI</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;burned&#39;</span><span class="p">)</span>


<span class="c1"># Calculate the pixel-by-pixel difference in canopy height between 2019 and 2021 for only the area in the Creek fire burn region</span>
<span class="n">chm_diff_burned</span> <span class="o">=</span> <span class="n">SOAP_2021_chm</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">SOAP_2019_chm</span><span class="p">)</span> \
                    <span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">creek_img</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> \
                    <span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">ROI</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Calculate the pixel-by-pixel difference in canopy height between 2019 and 2021 for only the area outside the Creek fire burn region</span>
<span class="n">chm_diff_unburned</span> <span class="o">=</span> <span class="n">SOAP_2021_chm</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">SOAP_2019_chm</span><span class="p">)</span> \
                    <span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">creek_img</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> \
                    <span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">ROI</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Plot difference in CHM</span>
<span class="kn">import</span> <span class="nn">geemap.chart</span> <span class="k">as</span> <span class="nn">chart</span>

<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;xlabel&quot;</span><span class="p">:</span> <span class="s2">&quot;Change in canopy height (m)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ylabel&quot;</span><span class="p">:</span> <span class="s2">&quot;Pixel count&quot;</span><span class="p">,</span>
    <span class="s2">&quot;colors&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;#1d6b99&quot;</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">chart</span><span class="o">.</span><span class="n">feature_histogram</span><span class="p">(</span><span class="n">chm_diff_burned</span><span class="p">,</span> <span class="s1">&#39;CHM&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Change in canopy height post-fire in the Creek Fire boundary&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">feature_histogram</span><span class="p">(</span><span class="n">chm_diff_unburned</span><span class="p">,</span> <span class="s1">&#39;CHM&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Change in canopy height post-fire outside the Creek Fire boundary&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>End-to-End Google Earth Engine</strong>: If you’d like to continue exploring the Earth Engine processes and applications, <a href="https://courses.spatialthoughts.com/end-to-end-gee.html#automatic-conversion-of-javascript-code-to-python" target="_blank"> SpatialThoughts Course - Ujaval Gandhi </a> has some nice examples you can follow.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./google_drive/colab_notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="pca_kmeans.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Principal Component Analysis &amp; Kmeans Clustering</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="disturbance_lidar.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Mapping Fire Impacts - LiDAR-based</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Mapping Fire Impacts - Raster-based</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reflection-exercises-for-each-group">Reflection exercises for each group:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgement">Acknowledgement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bringing-in-vector-data-fire-exploration">Bringing in vector data (fire exploration)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Carissa DeRanek & Jonathan Pando Ocón, PhD
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>